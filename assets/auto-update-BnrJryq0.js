let l;const c=/<script[^>]*src\s*=\s*["'](?<src>[^"']*)["'][^>]*>/gi;async function d(){const{origin:o,pathname:t}=window.location,e=o+t,s=await fetch(e+"?_timestamp="+Date.now()).then(a=>a.text());console.log(s,"html"),c.lastIndex=0;let n=[],r;for(;r=c.exec(s);)n.push(r.groups.src);return n}async function p(){const o=await d();if(console.log(o,"newScripts"),console.log(l,"lastSrcs"),!l)return l=o,!1;let t=!1;l.length!==o.length&&(t=!0);for(let e=0;e<l.length;e++)if(l[e]!==o[e]){t=!0;break}return l=o,t}function u(){return new Promise(o=>{const t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0.5)",t.style.zIndex="9999";const e=document.createElement("div");e.style.backgroundColor="#fff",e.style.padding="20px",e.style.borderRadius="5px",e.style.textAlign="center",e.style.margin="10% auto auto",e.style.width="35%";const s=document.createElement("p");s.textContent="页面脚本已更新，请点击确定获取最新版本。";const n=document.createElement("button");n.textContent="确定",n.style.marginTop="20px",n.style.padding="5px 30px",n.style.backgroundColor="#007bff",n.style.color="#fff",n.style.border="none",n.style.borderRadius="3px",n.style.cursor="pointer",n.addEventListener("click",()=>{document.body.removeChild(t),o()}),e.appendChild(s),e.appendChild(n),t.appendChild(e),document.body.appendChild(t)})}const y=2e3;function i(){setTimeout(async()=>{await p()&&(await u(),location.reload()),i()},y)}i();
